{"version":3,"sources":["../../src/server/index.js"],"names":["app","mongoose","connect","process","env","MONGO_URI","then","console","log","catch","err","use","bodyParser","urlencoded","extended","json","express","static","path","resolve","__dirname","passport","initialize","publicRoutes","authenticate","session","req","res","next","user","role","status","message","juniorsRoutes","coachesRoutes","get","_req","sendFile","listen","PORT"],"mappings":";;AAAA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;;;AAGA,MAAMA,GAAG,GAAG,uBAAZ;;AAGAC,kBACKC,OADL,CACaC,OAAO,CAACC,GAAR,CAAYC,SADzB,EAGKC,IAHL,CAGU,MACFC,OAAO,CAACC,GAAR,CAAY,0DAAZ,CAJR,EAMKC,KANL,CAMWC,GAAG,IAAIH,OAAO,CAACC,GAAR,CAAYE,GAAZ,CANlB;;AASAV,GAAG,CAACW,GAAJ,CAAQC,oBAAWC,UAAX,CAAsB;AAACC,EAAAA,QAAQ,EAAE;AAAX,CAAtB,CAAR;AACAd,GAAG,CAACW,GAAJ,CAAQC,oBAAWG,IAAX,EAAR;AACAf,GAAG,CAACW,GAAJ,CAAQK,iBAAQC,MAAR,CAAeC,cAAKC,OAAL,CAAaC,SAAb,EAAwB,kBAAxB,CAAf,CAAR;AACApB,GAAG,CAACW,GAAJ,CAAQU,kBAASC,UAAT,EAAR;AACAtB,GAAG,CAACW,GAAJ,CAAQ,oBAAR;AACA;AAGAX,GAAG,CAACW,GAAJ,CAAQ,MAAR,EAAgBY,eAAhB;AAGAvB,GAAG,CAACW,GAAJ,CACI,cADJ,EAEIU,kBAASG,YAAT,CAAsB,KAAtB,EAA6B;AAACC,EAAAA,OAAO,EAAE;AAAV,CAA7B,CAFJ,EAGI,CAACC,GAAD,EAAMC,GAAN,EAAWC,IAAX,KAAoB;AAChB,MAAIF,GAAG,CAACG,IAAJ,CAASC,IAAT,KAAkB,QAAtB,EAAgC;AAC5B,WAAOF,IAAI,EAAX;AACH;;AACD,SAAOD,GAAG,CAACI,MAAJ,CAAW,GAAX,EAAgBhB,IAAhB,CAAqB;AAACiB,IAAAA,OAAO,EAAE;AAAV,GAArB,CAAP;AACH,CARL,EASIC,gBATJ;AAaAjC,GAAG,CAACW,GAAJ,CACI,cADJ,EAEIU,kBAASG,YAAT,CAAsB,KAAtB,EAA6B;AAACC,EAAAA,OAAO,EAAE;AAAV,CAA7B,CAFJ,EAGI,CAACC,GAAD,EAAMC,GAAN,EAAWC,IAAX,KAAoB;AAChB,MAAIF,GAAG,CAACG,IAAJ,CAASC,IAAT,KAAkB,OAAtB,EAA+B;AAC3B,WAAOF,IAAI,EAAX;AACH;;AACD,SAAOD,GAAG,CAACI,MAAJ,CAAW,GAAX,EAAgBhB,IAAhB,CAAqB;AAACiB,IAAAA,OAAO,EAAE;AAAV,GAArB,CAAP;AACH,CARL,EASIE,gBATJ;AAaAlC,GAAG,CAACmC,GAAJ,CAAQ,GAAR,EAAa,CAACC,IAAD,EAAOT,GAAP,KAAe;AACxB,SAAOA,GAAG,CAACU,QAAJ,CAAanB,cAAKC,OAAL,CAAaC,SAAb,EAAwB,IAAxB,EAA8B,QAA9B,EAAwC,YAAxC,CAAb,CAAP;AACH,CAFD;AAIApB,GAAG,CAACsC,MAAJ,CAAWnC,OAAO,CAACC,GAAR,CAAYmC,IAAvB,EAA6B,MACzBhC,OAAO,CAACC,GAAR,CAAa,+BAA8BL,OAAO,CAACC,GAAR,CAAYmC,IAAK,GAA5D,CADJ","sourcesContent":["import express from \"express\";\nimport mongoose from \"mongoose\";\nimport bodyParser from \"body-parser\";\nimport path from \"path\";\nimport passport from \"passport\";\nimport publicRoutes from \"./routes/public\";\nimport coachesRoutes from \"./routes/coaches\";\nimport juniorsRoutes from \"./routes/juniors\";\nimport jwtStrategy from \"./configs/strategies\";\nimport cors from \"cors\";\n// import env from \"./configs/env\";\n\nconst app = express();\n\n// Connect to MongoDB.\nmongoose\n    .connect(process.env.MONGO_URI)\n    // .connect(\"mongodb://dev:dev@mongo:27017/bebook?authSource=admin\")\n    .then(() =>\n        console.log(\"Connection to MongoDB has been successfully established.\"),\n    )\n    .catch(err => console.log(err));\n\n// Middleware.\napp.use(bodyParser.urlencoded({extended: true}));\napp.use(bodyParser.json());\napp.use(express.static(path.resolve(__dirname, \"../../bin/client\")));\napp.use(passport.initialize());\napp.use(cors());\njwtStrategy();\n\n// Public API routes.\napp.use(\"/api\", publicRoutes);\n\n// Juniors only API routes.\napp.use(\n    \"/api/juniors\",\n    passport.authenticate(\"jwt\", {session: false}),\n    (req, res, next) => {\n        if (req.user.role === \"junior\") {\n            return next();\n        }\n        return res.status(401).json({message: \"Access denied!\"});\n    },\n    juniorsRoutes,\n);\n\n// Coaches only API routes.\napp.use(\n    \"/api/coaches\",\n    passport.authenticate(\"jwt\", {session: false}),\n    (req, res, next) => {\n        if (req.user.role === \"coach\") {\n            return next();\n        }\n        return res.status(401).json({message: \"Access denied!\"});\n    },\n    coachesRoutes,\n);\n\n// Handles any requests that don't match the ones above.\napp.get(\"*\", (_req, res) => {\n    return res.sendFile(path.resolve(__dirname, \"..\", \"client\", \"index.html\"));\n});\n\napp.listen(process.env.PORT, () =>\n    console.log(`Server is listening on port ${process.env.PORT}.`),\n);\n"],"file":"index.js"}